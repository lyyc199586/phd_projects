% Specify how elements are typeset inside the frame
\ProvidesPackage{theme/prattinner}

\newcommand*{\ClipSep}{0.06cm} %To adjust footer logo
\lstset{numbers=left, numberstyle=\tiny, stepnumber=1,firstnumber=1,breaklines=true,
    numbersep=5pt,language=Python,
    stringstyle=\ttfamily,
    basicstyle=\footnotesize,
    showstringspaces=false
}

% make beamer always use the frametitle template, even if frametitle is empty
\makeatletter
\patchcmd{\endbeamer@frameslide}{\ifx\beamer@frametitle\@empty}{\iffalse}{}{\errmessage{failed to patch}}
\makeatother

% --- Title Page ---
\makeatletter
\setbeamertemplate{title page}
{
    \vfill
    \begin{centering}
        \vskip0.75em%
        \begin{beamercolorbox}[sep=8pt,center]{title}
            \usebeamerfont{title}\inserttitle\par%
            \ifx\insertsubtitle\@empty%
            \else%
                \vskip0.25em%
                {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
            \fi%
        \end{beamercolorbox}%
        \vskip2.25em%
        {
            \usebeamercolor[fg]{titlegraphic}
            \inserttitlegraphic\par
        }
        \vskip1em\par
        \begin{beamercolorbox}[sep=8pt,center]{author}
            \usebeamerfont{author}\insertauthor
        \end{beamercolorbox}
        \begin{beamercolorbox}[sep=8pt,center]{institute}
            \usebeamerfont{institute}\insertinstitute
        \end{beamercolorbox}
        \begin{beamercolorbox}[sep=8pt,center]{date}
            \usebeamerfont{date}\insertdate
        \end{beamercolorbox}\vskip0.5em
    \end{centering}
    \vfill
}
\makeatother

% --- Footer ---
% Remove navigation bars
\setbeamertemplate{footline}[frame number]{}
% And Symbols
\setbeamertemplate{navigation symbols}{}
% Design
\setbeamertemplate{footline}{
    \tikzexternaldisable
    \begin{tikzpicture}[remember picture]
        \coordinate (one) at (0,0.5);
        \coordinate (two) at (0.03\textwidth,0.5);
        \coordinate (three) at (0.27\textwidth,0.5);
        \coordinate (four) at (\textwidth,0.5);
        \draw[oxfordblue, very thick] (one) -- (two);
        \draw[oxfordblue, very thick] (three) -- (four);
        \node [inner sep=0pt,clip,rounded corners=0.0cm] (oxlogo) at (0.15\textwidth,0.6) {\includegraphics[width=.25\textwidth]{theme/logos/duke-foot.png}};
        \node at (0.95\textwidth,0.25) {\large\insertframenumber / \large\inserttotalframenumber};
    \end{tikzpicture}
    \tikzexternalenable
}

% --- Header ---
\setbeamertemplate{frametitle}{

    \ifx\insertsubsectionhead\empty

        \ifx\insertsectionhead\empty

            \begin{beamercolorbox}[wd=\paperwidth,ht=2.75ex,dp=1.375ex]{frametitle}
                \hspace*{1ex}Overview
            \end{beamercolorbox}

            \par

            \tikzexternaldisable
            \begin{tikzpicture}[overlay]

                \coordinate (LeftEnd) at (-1, 0.3);
                \coordinate (LeftEndUnder) at (-1, 0.2);
                \coordinate (RightEnd) at (10, 0.3);
                \draw[oxfordblue, fill=oxfordblue] (LeftEnd)--(RightEnd)--(LeftEndUnder)--(LeftEnd);

                \coordinate (RightEnd) at (\paperwidth, 0.3);
                \coordinate (PreRightEnd) at (-1, 0.3);
                \draw[oxfordblue, thick] (RightEnd)--(PreRightEnd);

            \end{tikzpicture}
            \tikzexternalenable

        \else

            \begin{beamercolorbox}[wd=\paperwidth,ht=2.75ex,dp=1.375ex]{frametitle}
                \hspace*{1ex} \hfill {\large\insertsection} \hspace*{0ex}
            \end{beamercolorbox}

            \par

            \tikzexternaldisable
            \begin{tikzpicture}[overlay]

                \coordinate (LeftEnd) at (-1, 0.3);
                \coordinate (LeftEndUnder) at (-1, 0.2);
                \coordinate (RightEnd) at (10, 0.3);
                \draw[oxfordblue, fill=oxfordblue] (LeftEnd)--(RightEnd)--(LeftEndUnder)--(LeftEnd);

                \coordinate (RightEnd) at (\paperwidth, 0.3);
                \coordinate (PreRightEnd) at (-1, 0.3);
                \draw[oxfordblue, thick] (RightEnd)--(PreRightEnd);

            \end{tikzpicture}
            \tikzexternalenable

        \fi

    \else

        \begin{beamercolorbox}[wd=\paperwidth,ht=2.75ex,dp=1.375ex]{frametitle}
            \hspace*{1ex}\insertsubsection \hfill {\large\insertsection} \hspace*{0ex}
        \end{beamercolorbox}

        \par

        \tikzexternaldisable
        \begin{tikzpicture}[overlay]

            \coordinate (LeftEnd) at (-1, 0.3);
            \coordinate (LeftEndUnder) at (-1, 0.2);
            \coordinate (RightEnd) at (10, 0.3);
            \draw[oxfordblue, fill=oxfordblue] (LeftEnd)--(RightEnd)--(LeftEndUnder)--(LeftEnd);

            \coordinate (RightEnd) at (\paperwidth, 0.3);
            \coordinate (PreRightEnd) at (-1, 0.3);
            \draw[oxfordblue, thick] (RightEnd)--(PreRightEnd);

        \end{tikzpicture}
        \tikzexternalenable

    \fi

}

% --- Table of Content ---
% Might modify later (next version)

% --- Sidebar of Content ---
% Might add later (next version)
